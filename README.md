# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Данные и типы данных, используемые в приложении

Карточка товара

```
export interface IItem {
    _id:string;
    name:string;
    description:string;
    price:string;
    category:string[];
    image:string;
    satus:string;

}
```

Пользователь

```
export interface IUser{
    adress:string;
    email:string;
    telephone:string;
    paymethod:string;
    _id:string;
}
```
Интерфейс для модели данных  каталога карточек товара

```
export interface IItemData {
    items:IItem[];
    preview:string | null; 
    //поменять по аналогии с фильмами
}
```
Данные пользователя оформления заказа

```

```
Данные пользователя для платежа

```

```
Корзина

 ```

```

## Архитектура приложения
 Код приложения разделен на слои согласно парадигме MVP:
 - слой представления, отвечает за отображение данных на странице,
 - слой данных отвечает за хранение и изменение данных
 - презентер, отвечет за связь представления и данных

## Базовый код
#### Класс API
Содержит в себе базовую логику отправки запросов.  В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы:
-`get` - выполнаяет GET запрос на переданый в параметрах ендпойнт и возвращает промис с объектом, которым ответил сервер;
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпойнт, переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но м етод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отпарвлять события и подписываться на события, происходящие в системе. Классс используется в презентере для обработки событий и в слоях приложения для генерации событий.
Основные методы, реализуемые класссом, описаны интрефейсом `IEvents`:
- `on` - подписка на событие;
-`emit` - инициализация события;
-`trigger` - возращает функцию, при вызове которой инициализируется требуемое в параметрах событие.

### Слой данных

#### Класс IData
Класс отвечает за хранение и логику работы с данными карточек товара, полученных от сервера.\
Конструктор класса принимает инстант брокера событий\
В полях класса хранятся следующие данные:
 - _items: IItem[] - массив объектов карточек товаров.
 - _Preview: string | null - id карточки товара, выбранной для просмотра в модальном окне;
 - events: IEvents -экземпляр класса `EventEmitter` для инициации событий при изменении данных.
 Также  в классе имеются методы для взаимодействия с этими данными. 
 - updateItem(item:IItem,payload:Function | null = null):void - обновляет данные карточки товара в корзине. Если передан колбэк, то выполняет его после обновления, емли нет, то вызывает событие изменения массива.
 - getItem -  возвращает карточку товара по ее id.


  #### Класс UserData
  Класс отвечает за хранение и логику работы с данными текущего пользователя.\
  Конструктор класса принимает инстант брокера событий.\
  В полях класса хранятся следующие данные:
  - adress:string - адрес пользователя
  - email:string - почта пользователя
  - telephone:string - телефон пользователя
  - paymethod:string -выбранный пользователем способ оплаты
  - _id:string - уникальный идентификатор
  - events: IEvents -экземпляр класса `EventEmitter` для инициации событий при изменении данных.
  Также в классе имеется набор методов для взаимодействия с данными.
    checkvalidation(data:Record<keyof TUserInfo, string>):boolean - проверяет объект с данными пользователя на валидность.